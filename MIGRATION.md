# 移行計画（PR1〜PR3）

MerSearch Helper を安全に段階移行するための 3 本の PR をまとめた資料です。毎回の作業で完成基準と禁止事項をはっきりさせ、
初めて参加するメンバーでも迷わず進められるようにしています。

## PR ごとの概要と確認ポイント

| PR | 粒度（どこまで進めるか） | 対象ユースケース | 完了条件（DoD） | 参考リンク | 担当メモ |
| --- | --- | --- | --- | --- | --- |
| PR1 | 新ディレクトリ構成と TypeScript ラッパーの骨組みだけを追加する。既存ロジックは触らない。 | 既存の背景処理・コンテンツスクリプト・ポップアップの起点を TypeScript から参照できる状態にする準備。 | `npm run lint` / `npm run typecheck` / `npm run test` / `npm run e2e` / `npm run build` を全て完走させる。<br>動作を変える設定（manifest や公開エントリ名）を触らない。 | [`entrypoints/`](./entrypoints) の薄いラッパーファイルと [MIGRATION_PLAN.md](./MIGRATION_PLAN.md) の前段手順。 | 骨組みを作るだけなのでレビューでは「既存処理が動くか」の影響がないかを重点確認する。高校生向けに言えば、棚を組み立てただけで教科書はまだ移さない段階。 |
| PR2 | 最初のユースケース（例：♥ いいね数表示機能）を新構成へ移す。共通化は最小限。 | コンテンツスクリプトでの DOM 解析と表示処理を TypeScript ラッパー経由に差し替える。 | `npm run lint` / `npm run typecheck` / `npm run test` / `npm run e2e` / `npm run build` を全て完走させる。<br>旧コードとの動作比較をテストや手動確認で記録する。 | 既存の [`content.js`](./content.js) と新ラッパーの差分、関連テストは [`tests/`](./tests) 以下。 | 初回移行なので PR1 で用意した骨組みとの噛み合わせを入念に確認する。高校生向けには、新しい棚に最初の教科書セットを移して使い勝手を試すイメージ。 |
| PR3 | 二つ目のユースケース（例：検索結果のソート・フィルタ機能）を移行し、共通処理を抽出する。 | 背景スクリプトとポップアップ間の通信を新構成に合わせ、再利用できる関数を `src/` 以下へ整理する。 | `npm run lint` / `npm run typecheck` / `npm run test` / `npm run e2e` / `npm run build` を全て完走させる。<br>PR2 で追加した動作が壊れていないことを自動テストで保証する。 | 背景処理は [`background.js`](./background.js)、ポップアップ関連は [`popup.js`](./popup.js) と [`src/`](./src) のロジック。 | 共通化でファイルが動く範囲が広がるため、レビュアーは影響範囲の説明メモを書き残す。高校生向けには、別の段に二つ目の教材を移し、共有できる道具は一か所にまとめる段階。 |

## 各 PR で必ず確認するチェックリスト

- [ ] `manifest.json` の設定値や公開されているエントリポイント名を変更しない。
- [ ] スナップショットテストを更新した場合は、PR 本文またはレビューコメントに「なぜ必要だったのか」を書き残す。
- [ ] 変更理由と影響範囲を PR 説明文にリンク付きで整理する（関連ファイル・仕様書など）。

## 共有メモ

- 追加資料のリンクを PR コメントに貼ると後続メンバーが状況を追いやすくなります。例：デザイン仕様、Chrome 拡張の公開ページ、Playwright テストの記録動画など。
- 担当メモ欄には「テスト担当」「ドキュメント整備担当」など役割分担を書いておくと、引き継ぎ時に抜け漏れが出にくくなります。
- わからない点は、上記のリンク先かプロジェクト全体の [README](./README.md) を参照しながら確認してください。

> 🏫 **高校生向けレビューまとめ**: この移行計画は、学校の文化祭準備で道具を新しい倉庫に順番に移し替えるイメージです。最初は棚だけ組み立て、次に代表的な道具を移し、最後に他の道具も整理します。どの段階でもルール（棚の名前を勝手に変えない・写真を撮り直したら理由を書く）を守れば、誰でも安心して作業できます。
